{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/supabase.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../stars-rating/stars-rating.component\";\nfunction ReviewsListComponent_li_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\", 1)(1, \"div\", 2)(2, \"app-stars-rating\", 3);\n    i0.ɵɵlistener(\"overallChanged\", function ReviewsListComponent_li_0_Template_app_stars_rating_overallChanged_2_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r3);\n      const r_r1 = restoredCtx.$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.updateReview($event, r_r1));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 4);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"slice\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\");\n    i0.ɵɵelement(9, \"i\", 5);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"p\");\n    i0.ɵɵtext(12);\n    i0.ɵɵelement(13, \"i\", 6);\n    i0.ɵɵtext(14);\n    i0.ɵɵelement(15, \"i\", 7);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const r_r1 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"overall\", r_r1.overall);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(r_r1.summary);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", r_r1.unixReviewTime, \", \", i0.ɵɵpipeBind3(7, 7, r_r1.reviewText, 0, 50), \"... \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(r_r1.reviewerName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r0.gethelpfull(r_r1)[0]);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r0.gethelpfull(r_r1)[1]);\n  }\n}\nexport class ReviewsListComponent {\n  constructor(productsService) {\n    this.productsService = productsService;\n    this.reviews = [];\n  }\n  gethelpfull(review) {\n    return JSON.parse(review.helpful);\n  }\n  ngOnInit() {\n    this.productsService.getReviews(this.product.asin).subscribe(rev => this.reviews = rev);\n  }\n  updateReview($event, r) {\n    r.overall = $event;\n    this.productsService.updateReview(r).subscribe(status => console.log(\"Review modificada\"));\n  }\n}\nReviewsListComponent.ɵfac = function ReviewsListComponent_Factory(t) {\n  return new (t || ReviewsListComponent)(i0.ɵɵdirectiveInject(i1.SupabaseService));\n};\nReviewsListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ReviewsListComponent,\n  selectors: [[\"app-reviews-list\"]],\n  inputs: {\n    product: \"product\"\n  },\n  decls: 1,\n  vars: 1,\n  consts: [[\"class\", \"list-group-item\", 4, \"ngFor\", \"ngForOf\"], [1, \"list-group-item\"], [1, \"ms-2\", \"me-auto\"], [3, \"overall\", \"overallChanged\"], [1, \"fw-bold\"], [1, \"bi\", \"bi-person\"], [1, \"bi\", \"bi-hand-thumbs-up\"], [1, \"bi\", \"bi-hand-thumbs-down\"]],\n  template: function ReviewsListComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, ReviewsListComponent_li_0_Template, 16, 11, \"li\", 0);\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngForOf\", ctx.reviews);\n    }\n  },\n  dependencies: [i2.NgForOf, i3.StarsRatingComponent, i2.SlicePipe],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":";;;;;;;IAAAA,6BAAuD;IAENA;MAAA;MAAA;MAAA;MAAA,OAAkBA,gDAAuB;IAAA,EAAC;IAACA,iBAAmB;IACvGA,8BAAqB;IAAAA,YAAa;IAAAA,iBAAM;IACxCA,yBAAG;IAAAA,YAAuD;;IAAAA,iBAAI;IAC9DA,yBAAG;IAAAA,uBAA4B;IAAAA,aAAkB;IAAAA,iBAAI;IACrDA,0BAAG;IAAAA,aAAqB;IAAAA,wBAAoC;IAAAA,aAAqB;IAAAA,wBAAsC;IAAAA,iBAAI;;;;;IAJzGA,eAAqB;IAArBA,sCAAqB;IAClBA,eAAa;IAAbA,kCAAa;IAC/BA,eAAuD;IAAvDA,0GAAuD;IAC3BA,eAAkB;IAAlBA,uCAAkB;IAC9CA,eAAqB;IAArBA,iDAAqB;IAAoCA,eAAqB;IAArBA,iDAAqB;;;ACIzF,OAAM,MAAOC,oBAAoB;EAE/BC,YAAoBC,eAAgC;IAAhC,oBAAe,GAAfA,eAAe;IAGnC,YAAO,GAAc,EAAE;EAH+B;EAKtDC,WAAW,CAACC,MAAc;IACxB,OAAOC,IAAI,CAACC,KAAK,CAACF,MAAM,CAACG,OAAO,CAAC;EACnC;EAEAC,QAAQ;IACN,IAAI,CAACN,eAAe,CAACO,UAAU,CAAC,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC,CAACC,SAAS,CAC1DC,GAAc,IAAK,IAAI,CAACC,OAAO,GAAGD,GAAG,CACtC;EACH;EAEAE,YAAY,CAACC,MAAc,EAAEC,CAAU;IACrCA,CAAC,CAACC,OAAO,GAAGF,MAAM;IAClB,IAAI,CAACd,eAAe,CAACa,YAAY,CAACE,CAAC,CAAC,CAACL,SAAS,CAC3CO,MAAe,IAAKC,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC,CAEtD;EACH;;AAvBWrB,oBAAoB;mBAApBA,oBAAoB;AAAA;AAApBA,oBAAoB;QAApBA,oBAAoB;EAAAsB;EAAAC;IAAAb;EAAA;EAAAc;EAAAC;EAAAC;EAAAC;IAAA;MDVjC5B,qEAQO;;;MARmCA,qCAAW","names":["i0","ReviewsListComponent","constructor","productsService","gethelpfull","review","JSON","parse","helpful","ngOnInit","getReviews","product","asin","subscribe","rev","reviews","updateReview","$event","r","overall","status","console","log","selectors","inputs","decls","vars","consts","template"],"sourceRoot":"","sources":["/home/jose/repositorisIES/dwec-22-23/08 - angular/reviews/src/app/reviews/reviews-list/reviews-list.component.html","/home/jose/repositorisIES/dwec-22-23/08 - angular/reviews/src/app/reviews/reviews-list/reviews-list.component.ts"],"sourcesContent":["<li class=\"list-group-item\" *ngFor=\"let r of reviews;\">\n    <div class=\"ms-2 me-auto\">\n        <app-stars-rating [overall]=\"r.overall\"  (overallChanged)=\"updateReview($event, r)\"></app-stars-rating>\n        <div class=\"fw-bold\">{{r.summary}}</div>\n        <p>{{r.unixReviewTime}}, {{r.reviewText | slice:0:50}}... </p>\n        <p><i class=\"bi bi-person\"></i>{{r.reviewerName}}</p>\n        <p>{{gethelpfull(r)[0]}}<i class=\"bi bi-hand-thumbs-up\"></i>{{gethelpfull(r)[1]}}<i class=\"bi bi-hand-thumbs-down\"></i></p>\n      </div>\n  </li>","import { Component, Input, OnInit } from '@angular/core';\nimport { IProduct } from 'src/app/interfaces/i-product';\nimport { IReview } from 'src/app/interfaces/i-review';\nimport { SupabaseService } from 'src/app/services/supabase.service';\n\n@Component({\n  selector: 'app-reviews-list',\n  templateUrl: './reviews-list.component.html',\n  styleUrls: ['./reviews-list.component.css']\n})\nexport class ReviewsListComponent implements OnInit{\n\n  constructor(private productsService: SupabaseService){}\n\n  @Input() product!: IProduct;\n  reviews: IReview[] = [];\n\n  gethelpfull(review:IReview): number[]{\n    return JSON.parse(review.helpful);\n  }\n\n  ngOnInit(): void {\n    this.productsService.getReviews(this.product.asin).subscribe(\n     (rev: IReview[]) => this.reviews = rev, // Success function\n    );\n  }\n\n  updateReview($event: number, r: IReview){\n    r.overall = $event;\n    this.productsService.updateReview(r).subscribe(\n      (status: boolean) => console.log(\"Review modificada\")\n      \n    )\n  }\n\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}